executor.type = "uv"

[tasks]
_install = { shell = "uv sync --dev --frozen" }
_test = { shell = "pytest tests" }
_fix = { shell = 'ruff check . --fix' }
_lint = { shell = "mypy ./src" }
_format = { shell = "ruff format ." }
_pre_commit = { shell = "pre-commit run --all-files" }


[tasks.clean]
help = "Remove all files generated by builds and tests."
shell = "make clean"


[tasks.run]
shell = "uv run python -m sophia.main"


[tasks.check]
help = "Auto-fix and format the code using ruff."
sequence = ["_install", "_fix", "_lint", "_format"]
ignore_fail = false


[tasks.test]
sequence = ["_test"]


[tasks.check-test]
sequence = ["check", "_test"]


[tasks.update-db]
help = "Auto update local code base on the database."
shell = "make update-db"
